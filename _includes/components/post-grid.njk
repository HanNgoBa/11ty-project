<div class="posts-grid">
    {% for post in postsToDisplay %}
        {# Safe property access #}
        {% set featuredImage = post.featuredImage.node.sourceUrl if post.featuredImage and post.featuredImage.node else "http://headless-project.py-media.com/wp-content/uploads/2026/02/Image1.1.1.png" %}
        {% set category = post.categories.nodes[0].name if post.categories and post.categories.nodes and post.categories.nodes[0] else "" %}
        {% set author = "Admin" %}

        <article class="post-card">
            <div class="post-image">
                {% image featuredImage, post.title %}
                {% if category %}
                    <span class="category-badge">{{ category }}</span>
                {% endif %}
            </div>
            
            <div class="post-content">
                <h3>
                    <a href="/post/{{ post.slug }}/">{{ post.title | safe }}</a>
                </h3>
                <div class="excerpt">
                    {{ post.excerpt | safe }}
                </div>
                <div class="meta">
                    <span class="author">by <strong>{{ author }}</strong></span>
                    <span class="date">{{ post.date | postDate }}</span>
                </div>
            </div>
        </article>
    {% else %}
        <p>No posts found.</p>
    {% endfor %}
</div>
