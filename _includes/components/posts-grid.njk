<section class="posts-section">
    <div class="container">
        <div class="section-layout">
            <div class="posts-grid-container">
                <div class="posts-grid">
                    {% for post in posts %}
                        {# 1. Khai báo biến để check dữ liệu giống như JS #}
                        {% set featuredImage = post._embedded['wp:featuredmedia'][0].source_url if post._embedded['wp:featuredmedia'] else "http://headless-project.py-media.com/wp-content/uploads/2026/02/Image1.1.1.png" %}
                        {% set category = post._embedded['wp:term'][0][0].name if post._embedded['wp:term'][0][0] else "" %}
                        {% set author = post._embedded['author'][0].name if post._embedded['author'] else "Unknown" %}

                        <article class="post-card">
                            <div class="post-image">
                                <img src="{{ featuredImage }}" alt="{{ post.title.rendered | safe }}">
                                {% if category %}
                                    <span class="category-badge">{{ category }}</span>
                                {% endif %}
                            </div>
                            
                            <div class="post-content">
                                {# Lưu ý: Link href sửa lại cho khớp với cấu trúc 11ty của bạn #}
                                <h3>
                                    <a href="/post/{{ post.slug }}/">{{ post.title | safe }}</a>
                                </h3>
                                
                                <div class="excerpt">
                                    {{ post.excerpt.rendered | safe }}
                                </div>
                                
                                <div class="meta">
                                    <span class="author">by <strong>{{ author }}</strong></span>
                                    <span class="date">{{ post.date | postDate }}</span>
                                </div>
                            </div>
                        </article>
                    {% else %}
                        <p>No posts found.</p>
                    {% endfor %}
                </div>
            </div>
            
            {% include "components/sidebar.njk" %}
        </div>
    </div>
</section>

